---
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';

const lang = 'ru';

// Mock-данные альбомов
const albums = [
  {
    id: 'featured',
    slug: 'featured',
    title: 'Избранные фото',
    type: 'photo',
    coverImage: '/projects/klassika-poster.jpg',
    itemCount: 24,
    // Несколько превью для варианта "мозаика"
    previews: [
      '/projects/klassika-poster.jpg',
      '/projects/ogonek-2024-1.jpg',
      '/projects/holodok-2025-1.png',
      '/projects/ogonek-2024-2.jpg',
    ],
    date: '2025',
  },
  {
    id: 'portugal',
    slug: 'portugal-2025',
    title: 'Концерт в Португалии',
    type: 'photo',
    coverImage: '/projects/ogonek-2024-1.jpg',
    itemCount: 15,
    previews: [
      '/projects/ogonek-2024-1.jpg',
      '/projects/ogonek-2024-2.jpg',
      '/projects/klassika-poster.jpg',
    ],
    date: 'Ноябрь 2025',
  },
  {
    id: 'backstage',
    slug: 'backstage',
    title: 'Backstage',
    type: 'photo',
    coverImage: '/projects/holodok-2025-1.png',
    itemCount: 3,
    previews: [
      '/projects/holodok-2025-1.png',
      '/projects/holodok-2025-2.png',
      '/projects/holodok-2025-3.png',
    ],
    date: '2024-2025',
  },
  {
    id: 'ogonek-video',
    slug: 'ogonek-video',
    title: 'Видео с Огонька',
    type: 'video',
    coverImage: '/projects/ogonek-2024-2.jpg',
    itemCount: 5,
    previews: [
      '/projects/ogonek-2024-2.jpg',
    ],
    date: 'Август 2024',
  },
  {
    id: 'klassika-video',
    slug: 'klassika-video',
    title: 'Проект Классика',
    type: 'video',
    coverImage: '/projects/klassika-1.jpg',
    itemCount: 8,
    previews: [
      '/projects/klassika-1.jpg',
    ],
    date: '2025',
  },
];

const filters = [
  { key: 'all', label: 'Все' },
  { key: 'photo', label: 'Фото' },
  { key: 'video', label: 'Видео' },
];
---

<Layout title="Демо: Медиа — Альбомы" lang={lang}>
  <Header currentLang={lang} />
  
  <main class="pt-24 pb-20">
    <div class="fixed top-20 right-4 z-50 bg-amber-600/80 text-white px-3 py-1 text-xs font-medium rounded">
      ДЕМО: Медиа-альбомы
    </div>

    <div class="max-w-6xl mx-auto px-6">
      
      <!-- Заголовок -->
      <div class="text-center mb-12">
        <h1 class="text-4xl md:text-5xl font-light tracking-wide mb-4" style="font-family: var(--font-logo);">
          Медиа
        </h1>
        <p class="text-muted">
          Фото и видео
        </p>
      </div>
      
      <!-- Фильтры -->
      <div class="flex flex-wrap justify-center items-center gap-x-1 gap-y-2 mb-12" id="filters">
        {filters.map((filter, index) => (
          <>
            <button 
              class={`text-sm transition-all filter-btn px-2 py-1 bg-transparent border-0 cursor-pointer ${index === 0 ? 'text-white' : 'text-white/40 hover:text-white'}`}
              data-filter={filter.key}
            >
              {filter.label}
            </button>
            {index < filters.length - 1 && <span class="text-white/20">·</span>}
          </>
        ))}
      </div>

      <!-- Вариант 1: Сетка с одной обложкой -->
      <section class="mb-16">
        <h2 class="text-white/50 text-xs tracking-[0.2em] uppercase mb-6">Вариант 1: Одна обложка</h2>
        
        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4" id="albums-grid-v1">
          {albums.map((album) => (
            <a 
              href={`/_demo/album-page?album=${album.slug}`}
              class="album-card group block relative aspect-[4/3] overflow-hidden border border-white/10 hover:border-white/30 transition-all"
              data-type={album.type}
            >
              <img 
                src={album.coverImage} 
                alt={album.title}
                class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"
              />
              
              <!-- Градиент снизу -->
              <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent"></div>
              
              <!-- Бейдж типа -->
              {album.type === 'video' && (
                <div class="absolute top-3 right-3 bg-white/20 backdrop-blur-sm px-2 py-1 text-xs text-white rounded">
                  <svg class="w-3 h-3 inline mr-1" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M8 5v14l11-7z"/>
                  </svg>
                  Видео
                </div>
              )}
              
              <!-- Инфо внизу -->
              <div class="absolute bottom-0 left-0 right-0 p-4">
                <h3 class="text-white font-light text-sm md:text-base mb-1">{album.title}</h3>
                <p class="text-white/50 text-xs">
                  {album.itemCount} {album.type === 'video' ? 'видео' : 'фото'} · {album.date}
                </p>
              </div>
            </a>
          ))}
        </div>
      </section>

      <!-- Вариант 2: Мозаика превью -->
      <section class="mb-16">
        <h2 class="text-white/50 text-xs tracking-[0.2em] uppercase mb-6">Вариант 2: Мозаика превью (2×2)</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="albums-grid-v2">
          {albums.map((album) => (
            <a 
              href={`/_demo/album-page?album=${album.slug}`}
              class="album-card group block border border-white/10 hover:border-white/30 transition-all p-4"
              data-type={album.type}
            >
              <!-- Мозаика 2x2 -->
              <div class="grid grid-cols-2 gap-1 aspect-square mb-4 overflow-hidden">
                {album.previews.slice(0, 4).map((preview, i) => (
                  <div class={`relative overflow-hidden ${album.previews.length === 1 ? 'col-span-2 row-span-2' : ''}`}>
                    <img 
                      src={preview} 
                      alt=""
                      class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"
                    />
                    {album.type === 'video' && i === 0 && (
                      <div class="absolute inset-0 flex items-center justify-center bg-black/30">
                        <svg class="w-8 h-8 text-white/80" fill="currentColor" viewBox="0 0 24 24">
                          <path d="M8 5v14l11-7z"/>
                        </svg>
                      </div>
                    )}
                  </div>
                ))}
                {/* Заполнитель если меньше 4 фото */}
                {album.previews.length < 4 && album.previews.length > 1 && (
                  Array(4 - album.previews.length).fill(null).map(() => (
                    <div class="bg-white/5 flex items-center justify-center">
                      <span class="text-white/20 text-2xl">+</span>
                    </div>
                  ))
                )}
              </div>
              
              <!-- Инфо -->
              <div class="flex items-center justify-between">
                <div>
                  <h3 class="text-white font-light">{album.title}</h3>
                  <p class="text-white/50 text-xs">{album.date}</p>
                </div>
                <div class="text-white/40 text-sm">
                  {album.itemCount}
                </div>
              </div>
            </a>
          ))}
        </div>
      </section>

      <!-- Вариант 3: Список -->
      <section class="mb-16">
        <h2 class="text-white/50 text-xs tracking-[0.2em] uppercase mb-6">Вариант 3: Список (как события)</h2>
        
        <div class="space-y-3" id="albums-list">
          {albums.map((album) => (
            <a 
              href={`/_demo/album-page?album=${album.slug}`}
              class="album-card group flex items-center gap-4 p-4 border border-white/10 hover:border-white/30 hover:bg-white/5 transition-all"
              data-type={album.type}
            >
              <!-- Превью -->
              <div class="w-20 h-20 flex-shrink-0 overflow-hidden">
                <img 
                  src={album.coverImage} 
                  alt={album.title}
                  class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
                />
              </div>
              
              <!-- Инфо -->
              <div class="flex-1 min-w-0">
                <h3 class="text-white font-light flex items-center gap-2">
                  {album.type === 'video' && (
                    <svg class="w-4 h-4 text-white/50" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M8 5v14l11-7z"/>
                    </svg>
                  )}
                  {album.title}
                </h3>
                <p class="text-white/50 text-sm">
                  {album.itemCount} {album.type === 'video' ? 'видео' : 'фото'}
                </p>
              </div>
              
              <!-- Дата -->
              <div class="text-white/40 text-sm flex-shrink-0">
                {album.date}
              </div>
              
              <!-- Стрелка -->
              <svg class="w-4 h-4 text-white/30 group-hover:text-white transition-colors flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
              </svg>
            </a>
          ))}
        </div>
      </section>

      <!-- Вопросы для обсуждения -->
      <section class="mt-20 p-6 border border-white/10 bg-white/5">
        <h2 class="text-white text-lg mb-4">❓ Вопросы для обсуждения</h2>
        <ul class="text-muted text-sm space-y-2">
          <li>• Какой вариант превью лучше — одна обложка или мозаика?</li>
          <li>• Нужны ли фильтры Фото/Видео или всё вместе?</li>
          <li>• Показывать количество элементов или нет?</li>
          <li>• Формат даты — год или полная дата?</li>
        </ul>
      </section>

    </div>
  </main>
  
  <Footer />
</Layout>

<style>
  a {
    text-decoration: none !important;
  }
  
  .filter-btn {
    background: transparent !important;
    border: none !important;
    outline: none !important;
  }
  
  .album-card.hidden {
    display: none;
  }
</style>

<script>
  // Фильтрация альбомов
  const filterBtns = document.querySelectorAll('.filter-btn');
  const albumCards = document.querySelectorAll('.album-card');
  
  filterBtns.forEach(btn => {
    btn.addEventListener('click', () => {
      const filter = btn.dataset.filter;
      
      // Обновляем активную кнопку
      filterBtns.forEach(b => {
        b.classList.remove('text-white');
        b.classList.add('text-white/40');
      });
      btn.classList.remove('text-white/40');
      btn.classList.add('text-white');
      
      // Фильтруем альбомы
      albumCards.forEach(card => {
        const type = card.dataset.type;
        if (filter === 'all' || type === filter) {
          card.classList.remove('hidden');
        } else {
          card.classList.add('hidden');
        }
      });
    });
  });
</script>

