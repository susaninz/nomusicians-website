---
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/Header.astro';
import { getMusicians, getFamily, getCollaborators, getLinkIcon } from '../../data/people';
import { t } from '../../i18n/translations';

const lang = 'cn';

// Получаем данные из единого источника
const musicians = getMusicians();
const family = getFamily();
const collaborators = getCollaborators();

const homeUrl = '/cn/';
---

<Layout title="Musicians & Nomusicians — Nomusicians" lang={lang}>
  <Header currentLang={lang} />
  
  <main class="pt-24 pb-16">
    <!-- Hero -->
    <section class="px-6 mb-20">
      <div class="max-w-4xl mx-auto text-center">
        <h1 class="text-4xl md:text-6xl font-light tracking-wide mb-6" style="font-family: var(--font-logo);">
          Musicians<br/>
          <span class="text-muted">&</span><br/>
          Nomusicians
        </h1>
        <p class="text-lg text-muted max-w-2xl mx-auto">
          {t(lang, 'people.subtitle')}
        </p>
      </div>
    </section>

    <!-- Musicians Section -->
    <section class="mb-20">
      <div class="max-w-5xl mx-auto px-6">
        <h2 class="text-2xl font-light tracking-wide text-center mb-4">{t(lang, 'people.musicians')}</h2>
        <p class="text-muted text-center mb-12">{t(lang, 'people.musicians.sub')}</p>
        
        <div class="space-y-16">
          {musicians.map((person, index) => (
            <div 
              id={person.id}
              class:list={[
                "flex flex-col items-center gap-8",
                index % 2 === 0 ? 'md:flex-row' : 'md:flex-row-reverse'
              ]}
            >
              <div class="w-full md:w-1/2">
                <div class="aspect-square overflow-hidden group">
                  <img 
                    src={person.photo} 
                    alt={person.name}
                    class="w-full h-full object-cover grayscale group-hover:grayscale-0 transition-all duration-500"
                    loading="lazy"
                  />
                </div>
              </div>
              
              <div class="w-full md:w-1/2 text-center md:text-left space-y-4">
                <h3 class="text-2xl font-light tracking-wide text-white">{person.name}</h3>
                <p class="text-lg text-muted">{person.role}</p>
                <p class="text-sm text-white/50 tracking-wider">{person.instruments}</p>
                <p class="text-base leading-relaxed text-text/80">{person.bio}</p>
                
                {person.links && person.links.length > 0 && (
                  <div class="flex flex-wrap gap-3 justify-center md:justify-start">
                    {person.links.map(link => (
                      link.url ? (
                        <a 
                          href={link.url} 
                          target="_blank" 
                          rel="noopener noreferrer"
                          class="text-sm text-white/50 hover:text-white transition-colors"
                        >
                          {getLinkIcon(link.type)} {link.label}
                        </a>
                      ) : (
                        <span class="text-sm text-white/50">
                          {getLinkIcon(link.type)} {link.label}
                        </span>
                      )
                    ))}
                  </div>
                )}
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- Separator -->
    <div class="max-w-4xl mx-auto px-6 mb-20">
      <div class="border-t border-white/10 relative">
        <span class="absolute left-1/2 -translate-x-1/2 -translate-y-1/2 bg-background px-4 text-muted text-sm tracking-widest">
          FAMILY
        </span>
      </div>
    </div>

    <!-- Nomusicians Family Section -->
    <section class="mb-20">
      <div class="max-w-5xl mx-auto px-6">
        <h2 class="text-2xl font-light tracking-wide text-center mb-4">{t(lang, 'people.family')}</h2>
        <p class="text-muted text-center mb-12">{t(lang, 'people.family.sub')}</p>
        
        <div class="space-y-16">
          {family.map((person, index) => (
            <div 
              id={person.id}
              class:list={[
                "flex flex-col items-center gap-8",
                index % 2 === 0 ? 'md:flex-row' : 'md:flex-row-reverse'
              ]}
            >
              <div class="w-full md:w-1/2">
                <div class="aspect-square overflow-hidden group">
                  {person.photo ? (
                    <img 
                      src={person.photo} 
                      alt={person.name}
                      class="w-full h-full object-cover grayscale group-hover:grayscale-0 transition-all duration-500"
                      loading="lazy"
                    />
                  ) : (
                    <div class="w-full h-full bg-surface flex items-center justify-center">
                      <span class="text-6xl text-white/20">{person.name[0]}</span>
                    </div>
                  )}
                </div>
              </div>
              
              <div class="w-full md:w-1/2 text-center md:text-left space-y-4">
                <h3 class="text-2xl font-light tracking-wide text-white">{person.name}</h3>
                <p class="text-lg text-muted">{person.role}</p>
                {person.instruments && <p class="text-sm text-white/50 tracking-wider">{person.instruments}</p>}
                {person.bio && <p class="text-base leading-relaxed text-text/80">{person.bio}</p>}
                
                {person.links && person.links.length > 0 && (
                  <div class="flex flex-wrap gap-3 justify-center md:justify-start">
                    {person.links.map(link => (
                      link.url ? (
                        <a 
                          href={link.url} 
                          target="_blank" 
                          rel="noopener noreferrer"
                          class="text-sm text-white/50 hover:text-white transition-colors"
                        >
                          {getLinkIcon(link.type)} {link.label}
                        </a>
                      ) : (
                        <span class="text-sm text-white/50">
                          {getLinkIcon(link.type)} {link.label}
                        </span>
                      )
                    ))}
                  </div>
                )}
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- Separator -->
    <div class="max-w-4xl mx-auto px-6 mb-20">
      <div class="border-t border-white/10 relative">
        <span class="absolute left-1/2 -translate-x-1/2 -translate-y-1/2 bg-background px-4 text-muted text-sm tracking-widest">
          &
        </span>
      </div>
    </div>

    <!-- Nomusicians (Collaborators) Section -->
    <section class="mb-20">
      <div class="max-w-5xl mx-auto px-6">
        <h2 class="text-2xl font-light tracking-wide text-center mb-4">{t(lang, 'people.collaborators')}</h2>
        <p class="text-muted text-center mb-12">{t(lang, 'people.collaborators.sub')}</p>
        
        <div class="grid md:grid-cols-2 gap-12">
          {collaborators.map(person => (
            <div id={person.id} class="flex gap-6">
              <div class="w-24 h-24 flex-shrink-0 overflow-hidden group">
                <img 
                  src={person.photo} 
                  alt={person.name}
                  class="w-full h-full object-cover grayscale group-hover:grayscale-0 transition-all duration-500"
                  loading="lazy"
                />
              </div>
              
              <div class="space-y-2">
                <h3 class="text-lg font-light tracking-wide text-white">{person.name}</h3>
                <p class="text-sm text-muted">{person.role}</p>
                <p class="text-sm text-text/60">{person.description}</p>
                
                {person.projects && person.projects.length > 0 && (
                  <div class="flex flex-wrap gap-2">
                    {person.projects.map(project => (
                      <span class="text-xs text-white/40 bg-white/5 px-2 py-1 rounded">
                        {project}
                      </span>
                    ))}
                  </div>
                )}
                
                {person.links && person.links.length > 0 && (
                  <div class="flex flex-wrap gap-2">
                    {person.links.map(link => (
                      link.url ? (
                        <a 
                          href={link.url} 
                          target="_blank" 
                          rel="noopener noreferrer"
                          class="text-xs text-white/40 hover:text-white transition-colors"
                        >
                          {getLinkIcon(link.type)} {link.label}
                        </a>
                      ) : (
                        <span class="text-xs text-white/40">
                          {getLinkIcon(link.type)} {link.label}
                        </span>
                      )
                    ))}
                  </div>
                )}
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- Navigation -->
    <section class="px-6 py-16 text-center">
      <a 
        href={homeUrl}
        class="inline-flex items-center gap-2 text-white/60 hover:text-white transition-colors"
      >
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M7 16l-4-4m0 0l4-4m-4 4h18"></path>
        </svg>
        {t(lang, 'people.back')}
      </a>
    </section>
  </main>
</Layout>

