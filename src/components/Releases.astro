---
import type { Lang } from '../i18n/translations';
import { t } from '../i18n/translations';
import { releases } from '../data/releases';

interface Props {
  lang: Lang;
}

const { lang } = Astro.props;

const tabs = [
  { key: 'live', label: t(lang, 'releases.live') },
  { key: 'studio', label: t(lang, 'releases.studio') },
  { key: 'collabs', label: t(lang, 'releases.collabs') },
];
---

<section id="releases" class="py-24 px-6">
  <div class="max-w-6xl mx-auto">
    <h2 class="text-3xl md:text-4xl font-light tracking-wide text-center mb-12">
      {t(lang, 'releases.title')}
    </h2>
    
    <!-- Tabs -->
    <div class="flex justify-center gap-2 md:gap-4 mb-12">
      {tabs.map((tab, index) => (
        <button 
          class:list={[
            "release-tab px-4 py-2 text-sm md:text-base tracking-wider uppercase transition-all duration-300 border rounded-full",
            index === 0 
              ? "text-background bg-white border-white" 
              : "text-white/70 bg-transparent border-white/30 hover:border-white hover:text-white"
          ]}
          data-tab={tab.key}
        >
          {tab.label}
        </button>
      ))}
    </div>
    
    <!-- Live Releases Grid -->
    <div id="releases-live" class="release-content grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
      {releases.live.map((release) => (
        <a 
          href={release.soundcloud} 
          target="_blank" 
          rel="noopener noreferrer"
          class="group no-underline"
        >
          <div class="aspect-square overflow-hidden mb-3 bg-surface">
            <img 
              src={release.cover} 
              alt={release.title}
              class="w-full h-full object-cover transition-all duration-500 grayscale group-hover:grayscale-0 group-hover:scale-105"
              loading="lazy"
            />
          </div>
          <h3 class="text-sm md:text-base font-light tracking-wide text-center uppercase text-white group-hover:text-white/70 transition-colors">
            {release.title}
          </h3>
          <p class="text-xs text-muted text-center mt-1">
            {release.year}
          </p>
        </a>
      ))}
    </div>
    
    <!-- Studio Releases Grid -->
    <div id="releases-studio" class="release-content hidden grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
      {releases.studio.map((release) => (
        <a 
          href={release.soundcloud} 
          target="_blank" 
          rel="noopener noreferrer"
          class="group no-underline"
        >
          <div class="aspect-square overflow-hidden mb-3 bg-surface">
            <img 
              src={release.cover} 
              alt={release.title}
              class="w-full h-full object-cover transition-all duration-500 grayscale group-hover:grayscale-0 group-hover:scale-105"
              loading="lazy"
            />
          </div>
          <h3 class="text-sm md:text-base font-light tracking-wide text-center uppercase text-white group-hover:text-white/70 transition-colors">
            {release.title}
          </h3>
          <p class="text-xs text-muted text-center mt-1">
            {release.year}
          </p>
        </a>
      ))}
    </div>
    
    <!-- Collabs Releases Grid -->
    <div id="releases-collabs" class="release-content hidden grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
      {releases.collabs.map((release) => (
        <a 
          href={release.soundcloud} 
          target="_blank" 
          rel="noopener noreferrer"
          class="group no-underline"
        >
          <div class="aspect-square overflow-hidden mb-3 bg-surface">
            <img 
              src={release.cover} 
              alt={release.title}
              class="w-full h-full object-cover transition-all duration-500 grayscale group-hover:grayscale-0 group-hover:scale-105"
              loading="lazy"
            />
          </div>
          <h3 class="text-sm md:text-base font-light tracking-wide text-center uppercase text-white group-hover:text-white/70 transition-colors">
            {release.title}
          </h3>
          <p class="text-xs text-muted text-center mt-1">
            {release.artist && <span class="text-white/50">{release.artist} Â· </span>}
            {release.year}
          </p>
          {release.label && (
            <p class="text-xs text-white/40 text-center mt-0.5">
              {release.label}
            </p>
          )}
        </a>
      ))}
    </div>
  </div>
</section>

<script>
  const tabs = document.querySelectorAll('.release-tab');
  const contents = document.querySelectorAll('.release-content');
  
  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      const targetTab = tab.getAttribute('data-tab');
      
      // Update tabs styles
      tabs.forEach(t => {
        t.classList.remove('text-background', 'bg-white', 'border-white');
        t.classList.add('text-white/70', 'bg-transparent', 'border-white/30');
      });
      tab.classList.remove('text-white/70', 'bg-transparent', 'border-white/30');
      tab.classList.add('text-background', 'bg-white', 'border-white');
      
      // Show/hide content
      contents.forEach(content => {
        content.classList.add('hidden');
      });
      document.getElementById(`releases-${targetTab}`)?.classList.remove('hidden');
    });
  });
</script>
