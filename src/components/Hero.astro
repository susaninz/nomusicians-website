---
import type { Lang } from '../i18n/translations';
import { t } from '../i18n/translations';
import Logo3D from './Logo3D.astro';

interface Props {
  lang: Lang;
  use3DLogo?: boolean;
}

const { lang, use3DLogo = true } = Astro.props;

// Hero photos — random selection on each page load
// Each photo can have custom position (default: center)
const heroPhotos = [
  { url: '/hero/VGD_1998.jpg', position: 'center' },
  { url: '/hero/VGD_2151.jpg', position: 'center' },
  { url: '/hero/VGD_3073.jpg', position: 'center' },
  { url: '/hero/VGD_3241.jpg', position: 'center' },
];

// Random photo at build time (SSG) — will change on each deployment
// For truly random on each visit, we'll add client-side JS
const randomIndex = Math.floor(Math.random() * heroPhotos.length);
const selectedPhoto = heroPhotos[randomIndex];
---

<section id="hero" class="relative h-screen w-full overflow-hidden">
  <!-- Parallax Background Image -->
  <div class="absolute inset-0 overflow-hidden">
    <div 
      class="parallax-bg absolute inset-[-20%] bg-cover transition-opacity duration-1000"
      id="hero-parallax-bg"
      style={`background-image: url('${selectedPhoto.url}'); background-position: ${selectedPhoto.position}`}
      data-photos={JSON.stringify(heroPhotos)}
    ></div>
    <div class="absolute inset-0 bg-gradient-to-b from-black/50 via-black/30 to-black/80"></div>
  </div>
  
  <!-- Content -->
  <div class="relative z-10 flex h-full flex-col items-center justify-center px-6">
    {use3DLogo ? (
      <!-- 3D Logo -->
      <div class="relative w-full max-w-4xl h-48 md:h-64 lg:h-80">
        <Logo3D />
      </div>
    ) : (
      <!-- Fallback text logo -->
      <h1 class="text-5xl md:text-7xl lg:text-8xl font-light tracking-[0.15em] uppercase text-white" style="font-family: var(--font-logo);">
        Nomusicians
      </h1>
    )}
    
    <p class="mt-8 text-sm md:text-base tracking-[0.3em] uppercase text-white/70">
      {t(lang, 'hero.tagline')}
    </p>
  </div>
  
  <!-- Scroll indicator -->
  <div class="absolute bottom-8 left-1/2 -translate-x-1/2 animate-bounce">
    <svg class="w-6 h-6 text-white/50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
    </svg>
  </div>
</section>

<script>
  // Parallax effect for hero background
  const parallaxBg = document.getElementById('hero-parallax-bg');
  const hero = document.getElementById('hero');
  
  if (parallaxBg && hero) {
    // Random photo on each page visit (client-side)
    const photos = JSON.parse(parallaxBg.dataset.photos || '[]');
    if (photos.length > 0) {
      const randomPhoto = photos[Math.floor(Math.random() * photos.length)];
      parallaxBg.style.backgroundImage = `url('${randomPhoto.url}')`;
      parallaxBg.style.backgroundPosition = randomPhoto.position || 'center';
    }
    
    // Parallax scroll effect
    window.addEventListener('scroll', () => {
      const scrolled = window.scrollY;
      const rate = scrolled * 0.4;
      
      if (scrolled < window.innerHeight) {
        parallaxBg.style.transform = `translateY(${rate}px)`;
      }
    });
  }
</script>
